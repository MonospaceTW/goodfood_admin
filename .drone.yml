pipeline:
  install:
    image: node:10.9.0
    commands:
      # - yarn install
      - pwd


  # testing:
  #   image: node:10.9.0
  #   group: testing
  #   commands:
  #     - yarn run test
  
  scp:
    image: appleboy/drone-scp
    pull: true
    host:
      - 139.162.9.68
    port: 22
    username: root
    password: xup6jo3fup6
    target: /var/www/html/goodfood.tomaslin.com.tw/
    source:
      - /drone/src/github.com/horsekitlin/goodfood_admin
    when:
      branch: develop
      # status: [ suucess ]
  ssh:
    image: appleboy/drone-ssh
    host:
      - 139.162.9.68
    username: root
    password: xup6jo3fup6
    script:
      - echo ${ssh_key}
      - . /root/.nvm/nvm.sh && nvm use 10.9.0
      - mkdir -p /var/www/html/goodfood.tomaslin.com.tw
      # - cd goodfood_admin/drone/src/github.com/horsekitlin/goodfood_admin/
      # - yarn install && yarn build
      - pwd
      # - cp -a build/* /var/www/html/goodfood.tomaslin.com.tw/
      # - cd /root
      # - rm -rf ./goodfood_admin/
    when:
      branch: develop
